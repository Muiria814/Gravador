<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VozStudio</title>
    <link rel="stylesheet" href="estilo.css">
    <link rel="manifest" href="manifest.json">
    <style>
        body { font-family: Arial; padding: 20px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; text-align: center; }
        button { padding: 15px 30px; margin: 10px; font-size: 18px; border: none; border-radius: 10px; cursor: pointer; }
        .btn-gravar { background: #ff4444; color: white; }
        .btn-parar { background: #666; color: white; }
        .btn-gerar { background: #ffd700; color: black; padding: 20px 40px; font-size: 24px; }
        button:disabled { opacity: 0.5; }
        #waveform { width: 100%; height: 100px; background: rgba(255,255,255,0.1); margin: 20px 0; border-radius: 10px; }
        .erro { color: #ffaaaa; background: rgba(255,0,0,0.2); padding: 10px; border-radius: 10px; }
        .sucesso { color: #aaffaa; background: rgba(0,255,0,0.2); padding: 10px; border-radius: 10px; }
    </style>
</head>
<body>
    <h1>üé§ VozStudio</h1>
    <p>Grava a tua voz e cria m√∫sica autom√°tica</p>

    <canvas id="waveform" width="300" height="100"></canvas>
    
    <div>
        <button id="btnGravar" class="btn-gravar">üéôÔ∏è Gravar Voz</button>
        <button id="btnParar" class="btn-parar" disabled>‚èπÔ∏è Parar</button>
    </div>

    <div id="infoVoz">
        <p>Aguardando grava√ß√£o...</p>
    </div>

    <h3>üéõÔ∏è Configura√ß√µes</h3>
    <select id="estiloMusical">
        <option value="pop">Pop</option>
        <option value="rap">Rap</option>
        <option value="kizomba">Kizomba</option>
    </select>
    
    <p>BPM: <input type="range" id="bpm" min="60" max="180" value="100"> <span id="bpmValor">100</span></p>
    
    <button id="btnGerar" class="btn-gerar">‚ú® Criar M√∫sica ‚ú®</button>
    
    <div id="resultado" style="display:none; margin-top:20px;">
        <h3>üéµ Tua M√∫sica</h3>
        <audio id="player" controls></audio>
    </div>

    <!-- CARREGAR SCRIPTS (ORDEM CORRETA) -->
    <script src="https://cdn.jsdelivr.net/npm/tone"></script>
    <script src="gravador.js"></script>
    <script src="analisador.js"></script>
    <script src="gerador.js"></script>
    <script src="mixador.js"></script>
    <script src="app.js"></script>

    <!-- INICIALIZA√á√ÉO COM VERIFICA√á√ÉO -->
    <script>
        // Aguardar tudo carregar
        window.addEventListener('load', function() {
            console.log('üì± P√°gina carregada');
            
            // Verificar classes
            const classes = {
                'GravadorVoz': !!window.GravadorVoz,
                'AnalisadorVoz': !!window.AnalisadorVoz,
                'GeradorMusical': !!window.GeradorMusical,
                'MixadorProfissional': !!window.MixadorProfissional,
                'VozStudio': !!window.VozStudio
            };
            
            console.log('Classes verificadas:', classes);
            
            // Verificar se todas existem
            const todasExistem = Object.values(classes).every(v => v === true);
            
            if (!todasExistem) {
                const faltando = Object.entries(classes)
                    .filter(([_, existe]) => !existe)
                    .map(([nome]) => nome);
                    
                document.getElementById('infoVoz').innerHTML = 
                    `<p class="erro">‚ùå Erro: ${faltando.join(', ')} n√£o definido</p>`;
                return;
            }
            
            // Tudo ok, iniciar app
            try {
                window.app = new VozStudio();
                window.app.inicializar();
                document.getElementById('infoVoz').innerHTML = 
                    '<p class="sucesso">‚úÖ App pronta! Clique em Gravar Voz</p>';
            } catch (erro) {
                document.getElementById('infoVoz').innerHTML = 
                    `<p class="erro">‚ùå Erro: ${erro.message}</p>`;
            }
        });
    </script>
</body>
</html>